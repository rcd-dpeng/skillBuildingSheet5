# ////////////////////////////////////////////////////////////////
# /////////////////////////////////////////// IMPORT STATEMENTS //
# ////////////////////////////////////////////////////////////////


from kivy.app import App
from kivy.lang import Builder
from kivy.core.window import Window
from kivy.uix.screenmanager import ScreenManager, Screen
from kivy.uix.button import Button
from kivy.uix.floatlayout import FloatLayout
from kivy.graphics import *



# ////////////////////////////////////////////////////////////////
# ///////////////////////// DECLARE APP CLASS AND SCREENMANAGER //
# ////////////////////////////////////////////// LOAD KIVY FILE //
# ////////////////////////////////////////////////////////////////


class MyApp(App):
    def build(self):
        return sm

Builder.load_file('filename.kv')
sm = ScreenManager()
sm.add_widget(MainScreen(name = 'template'))
Window.clearcolor = (0.1, 0.1, 0.1, 1) # (WHITE)


# ////////////////////////////////////////////////////////////////
# //////////////////////////////////////// SLUSH/HARDWARE SETUP //
# ////////////////////////////////////////////////////////////////


import Slush
b = Slush.sBoard()
# example
stepperOne = Slush.Motor(0)
stepperTwo = Slush.Motor(1)
stepperOne.resetDev()
stepperTwo.resetDev()
stepperOne.setCurrent(20, 20, 20, 20)
stepperTwo.setCurrent(20, 20, 20, 20)
# ---


# ////////////////////////////////////////////////////////////////
# //////////////////////////////////////////// GLOBAL VARIABLES //
# /////////////////////////////////////////////////// CONSTANTS //
# ////////////////////////////////////////////////////////////////


# example
stepperSpeed = 400
# ---


# ////////////////////////////////////////////////////////////////
# ////////////////////////////////////////////// MAIN FUNCTIONS //
# ////////////////////// SHOULD INTERACT DIRECTLY WITH HARDWARE //
# ////////////////////////////////////////////////////////////////


# example
def runStepper(stepper):
    if stepper == 1:
	stepperOne.run(0, stepperSpeed)
    if stepper == 2:
	stepperTwo.run(0, stepperSpeed)
# ---


# ////////////////////////////////////////////////////////////////
# //////////////// DEFINE MAINSCREEN CLASS THAT KIVY RECOGNIZES //
# ////////////////////////////////////////////////////////////////
# ////// KIVY UI CAN INTERACT DIRECTLY W/ THE FUNCTIONS DEFINED //
# ////// SHOULD REFERENCE MAIN FUNCTIONS WITHIN THESE FUNCTIONS //
# ////////////// SHOULD NOT INTERACT DIRECTLY WITH THE HARDWARE //
# ////////////////////////////////////////////////////////////////


class MainScreen(Screen):

    # example
    def buttonAction(self, stepper):
        runStepper(stepper)
    # ---


# ////////////////////////////////////////////////////////////////
# ///////////////////////////////////////////////////// RUN APP //
# ////////////////////////////////////////////////////////////////


MyApp().run()
